<div class="min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-6">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-2xl font-bold mb-6 text-gray-800">User & Agent Management</h2>
  
    <!-- Tab Navigation -->
    <div class="flex mb-6">
      <button (click)="showUsers()" 
              [class.bg-blue-500]="view==='users'"
              [class.text-white]="view==='users'"
              [class.bg-white]="view!=='users'"
              [class.text-gray-600]="view!=='users'"
              class="px-4 py-2 rounded-l-lg border border-gray-300 font-medium">
        All Users
      </button>
      <button (click)="showAgents()" 
              [class.bg-blue-500]="view==='agents'"
              [class.text-white]="view==='agents'"
              [class.bg-white]="view!=='agents'"
              [class.text-gray-600]="view!=='agents'"
              class="px-4 py-2 border-t border-b border-gray-300 font-medium">
        Agents
      </button>
      <button (click)="showAssignments()" 
              [class.bg-blue-500]="view==='assignments'"
              [class.text-white]="view==='assignments'"
              [class.bg-white]="view!=='assignments'"
              [class.text-gray-600]="view!=='assignments'"
              class="px-4 py-2 rounded-r-lg border border-gray-300 font-medium">
        Assign Agents
      </button>
    </div>
  
    <!-- Loading State -->
    <div *ngIf="loading$ | async" class="text-center py-8">
      <div class="text-blue-600">Loading...</div>
    </div>
  
    <!-- Users Table -->
    <div *ngIf="view==='users' && !(loading$ | async)" class="bg-white/90 backdrop-blur-sm rounded-xl border border-gray-200 overflow-hidden shadow-lg">
      <div class="p-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-800">All Users</h3>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Name</th>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Email</th>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Role</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr *ngFor="let user of (users$ | async)" class="hover:bg-gray-50">
              <td class="px-4 py-3 text-gray-800 font-medium">{{ user.name }}</td>
              <td class="px-4 py-3 text-gray-600">{{ user.email }}</td>
              <td class="px-4 py-3">
                <span [class]="getRoleBadgeClass(user.role)" class="px-2 py-1 rounded text-xs font-medium">
                  {{ user.role | titlecase }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  
    <!-- Agents Table -->
    <div *ngIf="view==='agents' && !(loading$ | async)" class="bg-white/90 backdrop-blur-sm rounded-xl border border-gray-200 overflow-hidden shadow-lg">
      <div class="p-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-800">Insurance Agents</h3>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Name</th>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Email</th>
              <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Customers</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr *ngFor="let agent of (agents$ | async)" class="hover:bg-gray-50">
              <td class="px-4 py-3 text-gray-800 font-medium">{{ agent.name }}</td>
              <td class="px-4 py-3 text-gray-600">{{ agent.email }}</td>
              <td class="px-4 py-3 text-gray-600">{{ getAgentCustomerCount(agent._id) }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div *ngIf="view==='assignments' && !(loading$ | async)" class="bg-white/90 backdrop-blur-sm rounded-xl border border-gray-200 p-6 shadow-lg">
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-2">Assign Agent to Customer</h3>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
       
        <div class="bg-gray-50 rounded-lg p-4">
          <h4 class="text-md font-medium text-gray-800 mb-4">Select Customer</h4>
          <div class="space-y-2">
            <div *ngFor="let customer of getCustomers()" 
                 (click)="selectCustomer(customer)"
                 [class.bg-blue-500]="selectedCustomer?._id === customer._id"
                 [class.bg-white]="selectedCustomer?._id !== customer._id"
                 class="p-3 rounded cursor-pointer hover:bg-gray-100 border border-gray-200">
              <div class="font-medium" [class.text-white]="selectedCustomer?._id === customer._id" [class.text-gray-800]="selectedCustomer?._id !== customer._id">{{ customer.name }}</div>
              <div class="text-sm" [class.text-blue-100]="selectedCustomer?._id === customer._id" [class.text-gray-600]="selectedCustomer?._id !== customer._id">{{ customer.email }}</div>
              <div class="text-xs" [class.text-blue-200]="selectedCustomer?._id === customer._id" [class.text-gray-500]="selectedCustomer?._id !== customer._id">Current Agent: {{ getCustomerAgent(customer._id) || 'Unassigned' }}</div>
            </div>
          </div>
        </div>

       
        <div class="bg-gray-50 rounded-lg p-4">
          <h4 class="text-md font-medium text-gray-800 mb-4">Select Agent</h4>
          <div class="space-y-2">
            <div *ngFor="let agent of (agents$ | async)" 
                 (click)="selectAgent(agent)"
                 [class.bg-blue-500]="selectedAgent?._id === agent._id"
                 [class.bg-white]="selectedAgent?._id !== agent._id"
                 class="p-3 rounded cursor-pointer hover:bg-gray-100 border border-gray-200">
              <div class="font-medium" [class.text-white]="selectedAgent?._id === agent._id" [class.text-gray-800]="selectedAgent?._id !== agent._id">{{ agent.name }}</div>
              <div class="text-sm" [class.text-blue-100]="selectedAgent?._id === agent._id" [class.text-gray-600]="selectedAgent?._id !== agent._id">{{ agent.email }}</div>
              <div class="text-xs" [class.text-blue-200]="selectedAgent?._id === agent._id" [class.text-gray-500]="selectedAgent?._id !== agent._id">Customers: {{ getAgentCustomerCount(agent._id) }}</div>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-6 text-center">
        <button (click)="assignAgentToCustomer()" 
                [disabled]="!selectedCustomer || !selectedAgent"
                class="px-6 py-2 bg-gradient-to-r from-green-400 to-blue-400 text-white rounded hover:from-green-500 hover:to-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
          Assign Agent to Customer
        </button>
      </div>
    </div>

   
    <div *ngIf="(users$ | async)?.length === 0 && view==='users' && !(loading$ | async)" 
         class="text-center py-8">
      <div class="text-gray-600">
        <p class="text-lg font-medium mb-2">No users found</p>
        <p class="text-gray-500">No users have been registered yet.</p>
      </div>
    </div>

    <div *ngIf="(agents$ | async)?.length === 0 && view==='agents' && !(loading$ | async)" 
         class="text-center py-8">
      <div class="text-gray-600">
        <p class="text-lg font-medium mb-2">No agents found</p>
        <p class="text-gray-500">No agents have been created yet.</p>
      </div>
    </div>
  </div>
</div>
  